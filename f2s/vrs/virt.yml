id: virt
resources:
- id: role_data{{index}}
  from: f2s/resources/role_data
  location: '{{node}}'
  values:
    env: '{{env}}'
    uid: '{{index}}'
- id: ssl-keys-saving{{index}}
  from: f2s/resources/ssl-keys-saving
  location: '{{node}}'
  values_from: role_data{{index}}
- id: ssl-add-trust-chain{{index}}
  from: f2s/resources/ssl-add-trust-chain
  location: '{{node}}'
  values_from: role_data{{index}}
- id: logging{{index}}
  from: f2s/resources/logging
  location: '{{node}}'
  values_from: role_data{{index}}
- id: tools{{index}}
  from: f2s/resources/tools
  location: '{{node}}'
  values_from: role_data{{index}}
- id: netconfig{{index}}
  from: f2s/resources/netconfig
  location: '{{node}}'
  values_from: role_data{{index}}
- id: generate_vms{{index}}
  from: f2s/resources/generate_vms
  location: '{{node}}'
  values_from: role_data{{index}}
- id: connectivity_tests{{index}}
  from: f2s/resources/connectivity_tests
  location: '{{node}}'
  values_from: role_data{{index}}
events:
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: ssl-keys-saving{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=firewall
  depend_action: ssl-keys-saving{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: ssl-add-trust-chain{{index}}.run
- type: depends_on
  state: success
  parent_action: ssl-keys-saving{{index}}.run
  depend_action: ssl-add-trust-chain{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=firewall
  depend_action: ssl-add-trust-chain{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: logging{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: tools{{index}}.run
- type: depends_on
  state: success
  parent_action: logging{{index}}.run
  depend_action: tools{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: netconfig{{index}}.run
- type: depends_on
  state: success
  parent_action: tools{{index}}.run
  depend_action: netconfig{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: generate_vms{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: generate_vms{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: connectivity_tests{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: connectivity_tests{{index}}.run
