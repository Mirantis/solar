id: ironic
resources:
- id: role_data{{index}}
  from: f2s/resources/role_data
  location: '{{node}}'
  values:
    env: '{{env}}'
    puppet_modules: /etc/puppet/modules
    uid: '{{index}}'
    puppet_modules: '/etc/puppet/modules'
- id: fuel_pkgs{{index}}
  from: f2s/resources/fuel_pkgs
  location: '{{node}}'
  values_from: role_data{{index}}
- id: logging{{index}}
  from: f2s/resources/logging
  location: '{{node}}'
  values_from: role_data{{index}}
- id: tools{{index}}
  from: f2s/resources/tools
  location: '{{node}}'
  values_from: role_data{{index}}
- id: netconfig{{index}}
  from: f2s/resources/netconfig
  location: '{{node}}'
  values_from: role_data{{index}}
- id: connectivity_tests{{index}}
  from: f2s/resources/connectivity_tests
  location: '{{node}}'
  values_from: role_data{{index}}
- id: firewall{{index}}
  from: f2s/resources/firewall
  location: '{{node}}'
  values_from: role_data{{index}}
- id: hosts{{index}}
  from: f2s/resources/hosts
  location: '{{node}}'
  values_from: role_data{{index}}
- id: ironic-conductor{{index}}
  from: f2s/resources/ironic-conductor
  location: '{{node}}'
  values_from: role_data{{index}}
- id: ironic-compute{{index}}
  from: f2s/resources/ironic-compute
  location: '{{node}}'
  values_from: role_data{{index}}
- id: openstack-network-start{{index}}
  from: f2s/resources/openstack-network-start
  location: '{{node}}'
  values_from: role_data{{index}}
- id: openstack-network-common-config{{index}}
  from: f2s/resources/openstack-network-common-config
  location: '{{node}}'
  values_from: role_data{{index}}
- id: openstack-network-plugins-l2{{index}}
  from: f2s/resources/openstack-network-plugins-l2
  location: '{{node}}'
  values_from: role_data{{index}}
- id: openstack-network-end{{index}}
  from: f2s/resources/openstack-network-end
  location: '{{node}}'
  values_from: role_data{{index}}
events:
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: fuel_pkgs{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: logging{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: tools{{index}}.run
- type: depends_on
  state: success
  parent_action: logging{{index}}.run
  depend_action: tools{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: netconfig{{index}}.run
- type: depends_on
  state: success
  parent_action: tools{{index}}.run
  depend_action: netconfig{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: connectivity_tests{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: connectivity_tests{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: firewall{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: firewall{{index}}.run
- type: depends_on
  state: success
  parent_action: connectivity_tests{{index}}.run
  depend_action: firewall{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: hosts{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: hosts{{index}}.run
- type: depends_on
  state: success
  parent_action: connectivity_tests{{index}}.run
  depend_action: hosts{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=ssl-add-trust-chain
  depend_action: hosts{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: ironic-conductor{{index}}.run
- type: depends_on
  state: success
  parent_action: firewall{{index}}.run
  depend_action: ironic-conductor{{index}}.run
- type: depends_on
  state: success
  parent_action: hosts{{index}}.run
  depend_action: ironic-conductor{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: ironic-compute{{index}}.run
- type: depends_on
  state: success
  parent_action: firewall{{index}}.run
  depend_action: ironic-compute{{index}}.run
- type: depends_on
  state: success
  parent_action: hosts{{index}}.run
  depend_action: ironic-compute{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent_action: ironic-compute{{index}}.run
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent_action: netconfig{{index}}.run
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=neutron-keystone
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=neutron-db
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=top-role-compute
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-controller
  depend_action: openstack-network-start{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: openstack-network-common-config{{index}}.run
- type: depends_on
  state: success
  parent_action: openstack-network-start{{index}}.run
  depend_action: openstack-network-common-config{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: openstack-network-plugins-l2{{index}}.run
- type: depends_on
  state: success
  parent_action: openstack-network-common-config{{index}}.run
  depend_action: openstack-network-plugins-l2{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-server-config
  depend_action: openstack-network-plugins-l2{{index}}.run
- type: depends_on
  state: success
  parent_action: role_data{{index}}.run
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent_action: openstack-network-plugins-l2{{index}}.run
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent_action: openstack-network-common-config{{index}}.run
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=neutron-keystone
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-compute-nova
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-server-config
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=neutron-db
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-networks
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-routers
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-server-nova
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-agents-l3
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-agents-metadata
  depend_action: openstack-network-end{{index}}.run
- type: depends_on
  state: success
  parent:
    action: run
    with_tags:
    - resource=openstack-network-agents-dhcp
  depend_action: openstack-network-end{{index}}.run
